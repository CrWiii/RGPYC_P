<style type="text/css">
	table > tbody > tr > td {
		vertical-align: middle !important;
		text-align:center;
		padding-bottom: 4px !important;
		padding-top: 4px !important;
	}
</style>
<table id="nom"  width="100%" border="0" cellpadding="0" cellspacing="0" class="table table-bordered" style="white-space: nowrap;font-size: 11px !important">
	<thead>
		<tr style="background-color: #eff3f5 !important;color:#5c6a71 !important;">
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px">
				<a id="sorter" data-cont="num_ajuste" style="cursor: pointer !important;">N° Ajuste
					<i id="sort" data-cont="num_ajuste"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-long-arrow-down"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 90px;padding-left: 4px;">
				<a id="sorter" data-cont="cia_id" style="cursor: pointer !important;">Aseguradora 
					<i id="sort" data-cont="cia_id"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px;padding-left: 4px;" >
				<a  id="sorter" data-cont="num_siniestro_cia" style="cursor: pointer !important;">N° Siniestro
					<i id="sort" data-cont="num_siniestro_cia"  style="font-size: 11px;padding-top: 2px;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 75px;padding-left: 4px;" >
				<a  id="sorter" data-cont="broker_id" style="cursor: pointer !important;">Broker
					<i id="sort" data-cont="broker_id"  style="font-size: 11px;padding-top: 2px;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px;padding-left: 4px;" >
				<a  id="sorter" data-cont="num_siniestro_broker" style="cursor: pointer !important;">N° Broker
					<i id="sort" data-cont="num_siniestro_broker"  style="font-size: 11px;padding-top: 2px;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 95px;" >
				<a  id="sorter" data-cont="asegurado_name" style="cursor: pointer !important;">Asegurado
					<i id="sort" data-cont="asegurado_name"  style="font-size: 11px;padding-top: 2px;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 85px">
				<a id="sorter" data-cont="ramo_id" style="cursor: pointer !important;">Ramo
					<i id="sort" data-cont="ramo_id"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px;">
				<a  id="sorter" data-cont="num_poliza" style="cursor: pointer !important;">N° Poliza
					<i id="sort" data-cont="num_poliza"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px">
				<a  id="sorter" data-cont="fecha_siniestro" style="cursor: pointer !important;">F. Siniestro
					<i id="sort" data-cont="fecha_siniestro"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 50px">
				<a  id="sorter" data-cont="notifier_date" style="cursor: pointer !important;">F. Encargo
					<i id="sort" data-cont="notifier_date"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 70px">
				<a  id="sorter" data-cont="monto_reclamo" style="cursor: pointer !important;">M. Reclamado
					<i id="sort" data-cont="monto_reclamo"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px; width: 60px">
				<a  id="sorter" data-cont="reserva_inicial" style="cursor: pointer !important;">Reserva Neta
					<i id="sort" data-cont="reserva_inicial"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 30px">
				<a  id="sorter" data-cont="notifier_date" style="cursor: pointer !important;">Dias
					<i id="sort" data-cont="notifier_date"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 80px">
				<a  id="sorter" data-cont="fecha_iforme_final" style="cursor: pointer !important;">Ultimo Informe
					<i id="sort" data-cont="fecha_iforme_final"  style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
			<th style="text-align:center;padding-bottom: 4px;padding-top: 4px;width: 100px">
				<a  id="sorter" data-cont="estado_id" style="cursor: pointer !important;">Estado
					<i id="sort" data-cont="estado_id" style="font-size: 11px;padding-top: 2px;cursor: pointer !important;" class="fa fa-arrows-v"></i>
				</a>
			</th>
		</tr>
	</thead>
	<tbody>
		<?php use Carbon\Carbon; ?>
		@foreach($Casos as $Caso)
		<tr>
			<td><a href="{{url('DetallesCaso',array($Caso->id))}}" data-widget="" data-toggle="tooltip" title="@if(!empty($Caso->Ajustador)){{$Caso->Ajustador->search}} @endif">{{$Caso->num_ajuste}}</a></td>
			<td style="text-align: left"><i data-toggle="tooltip" title="{{$Caso->ejecutivo_aseguradora_name}}">@if(!empty($Caso->Cia)){{$Caso->Cia->nombre_comercial}} @endif</i></td> 
			<td style="text-align: left !important;">{{$Caso->num_siniestro_cia}}</td>
			<td style="text-align: left"><i data-toggle="tooltip" title="{{$Caso->ejecutivo_broker_name}}">@if(!empty($Caso->broker)){{$Caso->broker->description}} @endif</i></td>
			<td style="text-align: left !important">{{$Caso->num_siniestro_broker}}</td>
			<td style="text-align: left">{{$Caso->asegurado_name}}</td>
			<td style="text-align: left">@if(!empty($Caso->Ramo)){{$Caso->Ramo->description}}@endif</td>
			<td style="text-align: left !important;">{{$Caso->num_poliza}}</td>
			<td>@if(!empty($Caso->fecha_siniestro)){{date('d/m/Y', strtotime($Caso->fecha_siniestro))}}@endif</td>
			<td>@isset($Caso->notifier_date){{date('d/m/Y', strtotime($Caso->notifier_date))}}@endisset</td>
			<td style="text-align: right;">{{number_format($Caso->monto_reclamo,2)}}</td>
			<td style="text-align: right;">@isset($Caso->reserva_inicial){{number_format($Caso->reserva_inicial,2)}}@endisset</td>
			<td>@isset($Caso->notifier_date){{ Carbon::now()->diffInDays(Carbon::parse($Caso->notifier_date)) }}@endisset</td>
			<td>
				@if(!empty($Caso->Informe()->orderBy('created_at', 'desc')->first()->generated_at))
				{{$Caso->Informe()->orderBy('created_at', 'desc')->first()->num_informe}}
				@endif
			</td>
			<!-- $dtOttawa = Carbon::createFromDate(2000, 1, 1, 'America/Toronto'); -->
			<!-- $dtVancouver = Carbon::createFromDate(2000, 1, 1, 'America/Vancouver'); -->
			<!-- $dtOttawa->diffInHours($dtVancouver, false) -->
			<!-- if(!empty($Caso->notifier_date))$cd = date('Y-m-d H:i:s', strtotime($Caso->notifier_date)) -->
			<?php 
			$CWN_REG = null;
			if($Caso->notifier_date !== null){
				$FNO = Carbon::parse(date('Y-m-d H:i:s', strtotime($Caso->notifier_date)));
			}else{$FNO = null;}

			if($Caso->fecha_programada_inspeccion !==null){
				$FPI = Carbon::parse(date('Y-m-d H:i:s', strtotime($Caso->fecha_programada_inspeccion)));
			}else{$FPI = null;}

			if($FPI !== null && $FNO !== null){
				$DIFF_REG = $FPI->diffInHours($FNO);
			}else{$DIFF_REG = null;}

			if($FPI === null && $FNO !== null){
				$CWN_REG = $FNO->diffInHours();
			}
			?>
			<?php
			$CWN_INS = null;
			if($Caso->fecha_iforme_final !== null){
				$FIF = Carbon::parse(date('Y-m-d H:i:s', strtotime($Caso->fecha_iforme_final)));
			}else{$FIF = null;}
			if($FPI !== null && $FIF !== null){
				$DIFF_INS = $FIF->diffInHours($FPI);
			}else{$DIFF_INS = null;}
			if($FIF === null && $FPI !== null){
				$CWN_INS = $FPI->diffInHours();
			}

			?>


			<!-- <p @if($DIFF_REG> 24) style="background-color: red !important;"@endif>
											@isset($DIFF_REG) DIFF: {{$DIFF_REG}} | @endisset
											@isset($CWN_REG) CWN: {{$CWN_REG}} | @endisset
											@isset($FPI) FI: {{$FPI}} | @endisset
											@isset($FNO) FN: {{$FNO}} | @endisset
										</p> -->
										<!-- fecha_programada_inspeccion <<<< si esto esta en blanco rojo -->
										<!-- si el check de sin_inspeccion es true no pasar por la validacion de colores -->
										<!-- {{$Caso->created_at}} <br>
										{{$Caso->notifier_date}} -->

			<td style="text-align: left !important">
				<i data-toggle="tooltip" title="
				@if($Caso->estado_id == 1)
				@isset($CWN_REG) Han pasado: {{$CWN_REG}} horas de la fecha de notificación @endisset 
				@isset($DIFF_REG) Hay: {{$DIFF_REG}} diferencia de Horas entre la notificación y inspección  @endisset
				@endif

				@if($Caso->estado_id == 2)
				@isset($CWN_INS)  Han pasado: {{$CWN_INS}} horas de la fecha de inspección @endisset 
				@isset($DIFF_INS) Hay: {{$DIFF_INS}} diferencia de Horas entre la inspección y fin inspección  @endisset
				@endif
				">
				<span>
					<i class="fa fa-circle"

					@if($Caso->estado_id == 1)
					@isset($CWN_REG)
					@if($CWN_REG > 12 && $CWN_REG < 24)
					style="color:#ff7701 !important"
					@elseif($CWN_REG > 24) 
					style="color:#dd4b39 !important"
					@elseif($CWN_REG < 12)
					style="color:#00a65a !important"
					@endif
					@endisset

					@isset($DIFF_REG)
					@if($DIFF_REG > 12 && $DIFF_REG < 24)
					style="color:#ff7701 !important"
					@elseif($DIFF_REG > 24) 
					style="color:#dd4b39 !important"
					@elseif($DIFF_REG < 12)
					style="color:#00a65a !important"
					@endif
					@endisset

					@if($CWN_REG == null && $DIFF_REG == null)
					style="color:#dd4b39 !important"
					@endif
					@endif

					@if($Caso->estado_id == 2)
					@isset($CWN_INS)
					@if($CWN_INS > 12 && $CWN_INS < 24)
					style="color:#ff7701 !important"
					@elseif($CWN_INS > 24) 
					style="color:#dd4b39 !important"
					@elseif($CWN_INS < 12)
					style="color:#00a65a !important"
					@endif
					@endisset

					@isset($DIFF_REG)
					@if($DIFF_REG > 12 && $DIFF_REG < 24)
					style="color:#ff7701 !important"
					@elseif($DIFF_REG > 24) 
					style="color:#dd4b39 !important"
					@elseif($DIFF_REG < 12)
					style="color:#00a65a !important"
					@endif
					@endisset
					@endif


					@if($Caso->estado_id == 3)
					style="color:#00a65a !important"
					@endif

					@if($Caso->estado_id == 4)
					style="color: black !important"
					@endif

					@if($Caso->estado_id == 5)
					style="color:#00a65a !important"
					@endif

					@if($Caso->estado_id == 6)
					style="color:#00a65a !important"
					@endif

					@if($Caso->estado_id == 7)
					style="color:#286090 !important"
					@endif
					></i>
					<span style="padding-left: 10px !important">@if(!empty($Caso->Estado)){{$Caso->Estado->description}}@endif</span>
				</span>
			</td>

		</tr>
		@endforeach
	</tbody>
</table>
<input type="hidden" id="TotResultCases" value="{{$TotResultCases}}">
<div class="box-footer clearfix" style="text-align: center;padding: 0px !important;">
	<div id="pagi" >
		{!! $Casos->render() !!}
	</div>
	<style type="text/css">
		.pagination{margin-top: 5px !important;margin-bottom: 5px !important;}
	</style>
</div>